# 用户

构造两个函数来辅助：

## 1. check_token

接受两个参数:

1. user_id: 要验证token的用户名；
2. token: 要验证的token。

返回值是一个元组(整数，字符串)

1. 整数代表操作码，200 表示成功，5XX表示某种错误；
2. 字符串描述操作的结果。

函数流程：

1. 查询数据库中该user_id的信息；
2. 如果该用户名不存在，返回错误信息；
3. 从数据库中获取db_token;
4. 使用__check_token()函数验证输入的 token 跟数据库中存放的 db_token 是否一致；
5. 如果验证失败，返回错误信息；
6. 如果验证成功，返回操作码 200 和 "ok"。

## 2. chexk_password

接受两个参数:

1. user_id: 要验证密码的用户名；
2. password: 要验证的密码。

返回值是一个元组(整数，字符串)

1. 整数代表操作码，200 表示成功，5XX表示某种错误；
2. 字符串描述操作的结果。

函数流程：

1. 查询数据库中该user_id的信息；
2. 如果该用户名不存在，返回错误信息；
3. 从数据库中获取db_password;
4. 验证输入的密码跟数据库中存放的密码是否一致；
5. 如果验证失败，返回错误信息；
6. 如果验证成功，返回操作码 200 和 "ok"。

## 用户注册与注销

register()接受两个参数：

1. user_id:用户注册账号的用户名
2. password:用户的密码

返回值是一个元组:(整数，字符串)

1. 整数代表操作码，200表示注册成功，5XX代表错误
2. 字符串来描述操作结果

函数流程：

1. 首先生成一个唯一的terminal；
2. 生成一个token;
3. 将用户的信息插入到数据库中，包括user_id, password, balance, token, terminal;
4. 如果在上述过程中发生了任何异常，捕获异常，返回错误信息；
5. 如果未发生异常，则操作成功，返回操作码 200 和"ok"。

unregister()接受两个参数：

1. user_id: 要注销的用户名；
2. password: 用户名对应的密码。

返回值也是一个元组：(整数，字符串)

1. 整数代表操作码，200表示操作成功，401表示操作异常；
2. 字符串描述操作的结果。

函数流程：

1. 调用check_password()来检查账户名跟密码是否正确；
2. 如果验证失败，返回错误码和错误信息；
3. 如果验证成功，从数据库中删除该用户名和对应的密码；
4. 检查删除的结果，如果成功删除了一个用户，就返回操作码 200 和 "ok" 表示操作成功；
5. 如果未能成功删除该用户，则返回错误信息；
6. 如果在上述过程中发生任何异常，返回异常操作码和错误信息。

## 用户登入和登出

login函数接受三个参数：

1. user_id: 要登录账户的用户名；
2. password: 该账户的密码；
3. terminal: 终端标识。

返回值是三元组(整数，字符串，字符串)、

1. 整数代表操作码，200 表示成功；
2. 第一个字符串描述操作的结果；
3. 第二个字符串代表生成的token。

函数流程：

1. 调用 check_password 函数验证用户名和密码是否正确；
2. 生成新的token；
3. 更新数据库中该账户的信息，包括 token 和 terminal。
异常处理就不再描述。

logout() 接受两个参数：

1. user_id: 要登出的用户名；
2. token: 用户的令牌。

返回值是一个元组(整数，字符串)

1. 整数代表操作码；
2. 字符串描述操作结果。

函数流程： 